<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    
    <form id="test-for-formdata" style="background-color: beige;">
        <input type="text" id="text" name="text">
        <br>
        <input type="file" id="file" name="file">
        <br>
        <input type="button" value="Send" onclick="upload()">
    </form>

    <script>
        function upload() {
            const url = 'https://hms.jedlik.cloud/api/publicpages/gallery/uploadasform';

            const formData = new FormData(document.getElementById('test-for-formdata'));
            console.log(formData);
            const fetchOptions = {
                method: 'post',
                body: formData
            };


            fetch(url, fetchOptions);
        }
    </script>

    <br><br>

    <form id="test-for-base64" style="background-color: lightblue;">
        <input type="text" id="text2">
        <br>
        <input type="file" id="file2">
        <br>
        <input type="button" value="Send" onclick="uploadBase64()">
    </form>

    <script>

        const fileToBase64 = file => new Promise((resolve, reject) => {
            const reader = new FileReader();
            reader.onload = () => resolve(reader.result.replace('data:', '').replace(/^.+,/, ''));
            reader.onerror = reject;
            reader.readAsDataURL(file);
            
        });

        function uploadBase64() {            
            var file = document.getElementById('file2').files[0];
            fileToBase64(file)
                .then( base64 => {
                    console.log(base64);
                    const url = 'http://localhost:5034/publicpages/gallery/uploadasbase64';
                    //const url = 'https://hms.jedlik.cloud/api/publicpages/gallery/uploadasbase64';
                    
                    const fetchOptions = {
                        method: 'post',
                        headers: {
                            "Content-Type": "application/json",
                        },
                        body: JSON.stringify({
                            file: base64,
                            filename: file.name,
                            text: document.getElementById('text2').value
                        }),

                    };
                    fetch(url, fetchOptions);
                })
                .catch( err => {
                    console.log(err)
                });
        }


    </script>
</body>
</html>